# Railway Database Setup Guide

Your AI quiz generation is failing because Railway can't connect to local databases. Here's how to fix it using Railway's managed databases:

## üîß Quick Fix Steps

### 1. Add MongoDB Service in Railway

1. Go to your Railway dashboard
2. Select your `smartquizapp-production-cffd` project
3. Click "New" ‚Üí "Database" ‚Üí "Add MongoDB"
4. Railway will automatically:
   - Create a MongoDB instance
   - Set the `MONGODB_URI` environment variable
   - Connect it to your service

### 2. Verify Environment Variables

Make sure these are set in Railway Variables tab:

```
MONGODB_URI=<auto-generated by Railway MongoDB service>
GEMINI_API_KEY=AIzaSyBHy5ELcCrG_W5NJQLRFwhrFa_zLjA9DPs
JWT_SECRET=ba174232da61c4cfa12a5d7bfa769a04d81a90f089ff6ed3cba64266745629a49eec17aeeeb634c095288cf0a9965226d016881e4d14c9a7d18378ecdcd624d8
NODE_ENV=production
```

### 3. Optional: Add Redis Service

1. In Railway dashboard, click "New" ‚Üí "Database" ‚Üí "Add Redis"
2. Railway will automatically set `REDIS_URL` variable
3. This improves performance but isn't required

### 4. Redeploy

After setting variables, Railway will automatically redeploy your app.

## ‚úÖ Test Your Fix

1. Wait for deployment to complete
2. Visit: `https://smartquizapp-production-cffd.up.railway.app/api/health`
3. Should return: `{"status":"OK","message":"Server is running"}`
4. Test AI quiz generation in your app

## üö® Current Issues

- **MongoDB**: Trying to connect to `localhost:27018` (doesn't exist on Railway)
- **Redis**: Trying to connect to `localhost:6380` (doesn't exist on Railway)
- **Result**: 500 Internal Server Error when generating quizzes

## üìã Environment Variables Needed

| Variable | Required | Description |
|----------|----------|-------------|
| `MONGODB_URI` | ‚úÖ Yes | Auto-generated when you add MongoDB service |
| `GEMINI_API_KEY` | ‚úÖ Yes | Your Google AI API key |
| `JWT_SECRET` | ‚úÖ Yes | Secret for JWT tokens |
| `NODE_ENV` | ‚úÖ Yes | Set to `production` |
| `REDIS_URL` | ‚ùå Optional | Auto-generated when you add Redis service |

## üîç Troubleshooting

If still not working:

1. Check Railway logs for database connection errors
2. Ensure MongoDB service is running (green status in Railway dashboard)
3. Try removing and re-adding the MongoDB service
4. Check that services are properly linked in Railway

## üí° Why This Happened

Your local `.env` file has development database URLs (`localhost:27018`) that don't work in production. Railway needs its own managed database services.

## üéØ Railway Database Benefits

- **Automatic setup**: No manual connection strings
- **Auto-scaling**: Handles traffic spikes
- **Backups**: Built-in data protection  
- **Monitoring**: Built-in performance metrics
- **Security**: Automatic SSL/TLS encryption